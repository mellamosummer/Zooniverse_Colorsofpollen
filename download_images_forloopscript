Summer Blanco
PhD student
Shu-Mei Chang & Jim Leebens-Mack Lab
September 22, 2022

Ilastik Image download script

#This scripts uses Zooniverse species manifest csv files with image url,
#gbif ID, and species name to download images for ALL geranium species into
#individual folders

in directory /speciesmanifests there are 100+ csv files

#move the csvs into their own directory
mkdir csvs
mv *.csv csvs

#saves image link from species manifest
for i in *.csv
do
cat $i | sed '1d' | cut -d , -f 1 >links_$i
done

#save file names from previous file
for i in links*
do
cut -d / -f 5 $i | sed 's/$/.jpeg/' > filenames_$i
done

#move image links & file names to own directory
mkdir links
mv *links* links

#make individual species folders
for file in *.csv
do
dir="${file%.csv}"
mkdir -- "$dir"
mv -- "$file" "$dir"
done

#move link files back
mv links/* .
rm -r links

#move all files into same name dir
for dir in */; do find . -mindepth 1 -maxdepth 1 -type f -name "*${dir%*/}*.csv" -exec mv {} ${dir}/ \;; done

#for loop to make output_file
for dir in */
do
paste $dir/link* $dir/file* | sed 's/\t/,/g' > $dir/output_file
done

#subargenteum, argenteum, robertianum picard, and Picard didnt work for some reason so need to so individually

#saves image link from species manifest
cd subargenteum
cat subargenteum.csv| sed '1d' | cut -d , -f 1 >links_subargenteum.csv
cat links_subargenteum.csv| cut -d / -f 5 | sed 's/$/.jpeg/' > filenames_subargenteum.csv
paste links_subargenteum.csv filenames_subargenteum.csv | sed 's/\t/,/g' > output_file
cd ..

cd robertianum_Picard
cat robertianum_Picard.csv| sed '1d' | cut -d , -f 1 >links_robertianum_Picard.csv
cat links_robertianum_Picard.csv| cut -d / -f 5 | sed 's/$/.jpeg/' > filenames_robertianum_Picard.csv
paste links_robertianum_Picard.csv filenames_robertianum_Picard.csv | sed 's/\t/,/g' > output_file
cd ..

cd Picard
rm *robertianum*
cat Picard.csv| sed '1d' | cut -d , -f 1 >links_Picard.csv
cat links_Picard.csv| cut -d / -f 5 | sed 's/$/.jpeg/' > filenames_Picard.csv
paste links_Picard.csv filenames_Picard.csv | sed 's/\t/,/g' > output_file
cd ..


#for loop to
for dir in */
do
while IFS=, read url name
do
wget -O ${dir}/${name} ${url}
done<${dir}/output_file
done
